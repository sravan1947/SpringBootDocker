name: Docker Image CI

on:
  push:
    branches: [ "master" ]
  pull_request:
    branches: [ "master" ]

jobs:
    build:
    uses: anujdevopslearn/GithubActions/.github/workflows/maven-reusable.yml@master
deploy:
  runs-on: ubuntu-latest
  needs: build
environment:
  name: 'Production'
  url: ${{ steps.deploy-to-webapp.outputs.webapp-url }}

steps:
- name: Download artifact from build job
uses: actions/download-artifact@v2
with:
name: java-app

- name: Deploy to Azure Web App
  id: deploy-to-webapp
  uses: azure/webapps-deploy@v2
with:
  app-name: 'JavaAppAnuj'
  slot-name: 'Production'
  publish-profile: ${{ secrets.AZUREAPPSERVICE_PUBLISHPROFILE_7C654800D6C44D0FB51BB1A43B677602 }}
  package: '*.jar'
